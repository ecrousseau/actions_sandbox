name: Example-Action

# When to run
on: push  # remove 'push' and un-comment the below to run on a schedule
  #schedule:
  #- cron: '*/15 * * * *' # every 15 minutes - for help with cron expressions see https://crontab.guru/

# What to do
jobs:
  example-action: # this name is used if a "display name" is not set below
    name: My Example Job 
    runs-on: ubuntu-latest
    steps:
      # Checks out a copy of your repository
      - name: Checkout this repo 🛎️
        uses: actions/checkout@v2.3.1
        with:
          persist-credentials: false
      # Checks out a copy of another repository
      - name: Checkout terraform-aws-ec2-instance 🛎️
        uses: actions/checkout@v2.3.1
        with:
          repository: terraform-aws-modules/terraform-aws-ec2-instance
          ref: v2.15.0
          path: terraform-aws-ec2-instance
          fetch-depth: 0
      - name: Get tags for terraform-aws-ec2-instance
        run:  cd terraform-aws-ec2-instance && git fetch origin +refs/tags/*:refs/tags/*
      # Set up python
      - name: Set up Python 3.x 🐍
        uses: actions/setup-python@v2
        with:
          python-version: 3.x
      # Run a python script
      - name: Run script 🔧
        run: |
          curl -LO https://github.com/richardjkendall/tf-auto-document/releases/download/v1.005/tf-auto-document_v1.005_linux_amd64.tar.gz
          tar xf tf-auto-document_v1.005_linux_amd64.tar.gz
          ls -lha > ls.txt
          chmod +x tf-auto-document
          mkdir gh-pages
          python script.py > gh-pages/index.md
          cd gh-pages
      #../tf-auto-document ../terraform-aws-ec2-instance
      # Deploy pages
      - name: Deploy pages 🚀
        uses: JamesIves/github-pages-deploy-action@3.6.2
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          BRANCH: gh-pages
          FOLDER: gh-pages
          CLEAN: true